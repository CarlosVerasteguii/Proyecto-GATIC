# Retrospectiva — Epic 1: Acceso seguro y administración de usuarios

- Proyecto: GATIC
- Fecha: 2025-12-30
- Epic: 1
- Fuente de tracking: _bmad-output/implementation-artifacts/sprint-status.yaml
- Evidencia principal: stories _bmad-output/implementation-artifacts/1-*.md + artefactos _bmad-output/*.

## Participantes

- Carlos (Project Lead)
- Bob (Scrum Master)
- Alice (Product Owner)
- Charlie (Senior Dev)
- Dana (QA Engineer)
- Elena (Junior Dev)
- Winston (Architect)

## Resumen del Epic

Epic 1 dejó una base operativa para: autenticación (login/logout), UI base (Bootstrap 5 + copy ES), Livewire 3 integrado, RBAC inicial (roles/gates/policies), layout con navegación por rol, patrones UX reutilizables (toasts/overlay/freshness), manejo de errores en producción con `error_id`, y un patrón estándar de polling.

### Métricas (según sprint-status)

- Historias completadas: 11/11 (100%)
- Story points / sprints: N/D en artefactos

### Historias entregadas

- 1.1 Repo inicial (layout) + Laravel 11 base
- 1.2 Entorno local con Sail + MySQL 8 + seeders mínimos
- 1.3 Autenticación base (Breeze Blade) operativa
- 1.4 UI base Bootstrap 5 (sin Tailwind) alineada a guía visual
- 1.5 Livewire 3 instalado e integrado en el layout
- 1.6 Roles fijos + policies/gates base (server-side)
- 1.7 Calidad y CI mínima (Pint + PHPUnit + Larastan)
- 1.8 Layout base (sidebar/topbar) + navegación por rol
- 1.9 Componentes UX reutilizables (toasts, loaders, cancelar, “Actualizado hace Xs”)
- 1.10 Manejo de errores en producción con ID (detalle solo Admin)
- 1.11 Patrón de polling base (wire:poll.visible) reutilizable

## Lo que salió bien (fortalezas)

- Guardrails consistentes: todas las stories mantuvieron alineación con arquitectura/“project context”, reduciendo drift y scope creep.
- Calidad como hábito: en la mayoría de stories hay evidencia explícita de validación (tests, Pint y/o Larastan) y reportes de validación.
- Correcciones guiadas por code review: hallazgos HIGH/MEDIUM se atendieron y quedaron documentados con fixes concretos.
- Patrones reutilizables listos para escalar: UI (toasts/overlay/freshness), errores con `error_id`, polling wrapper/config y navegación por rol.

## Desafíos (áreas de mejora)

- Enforce de merges: NO activaremos Branch Protection (repo privado / restricciones de plan). Mitigacion: merges a `main` solo via PR + CI verde verificado manualmente.
- Consistencia de entorno: hubo señales de desalineación de versión de PHP (se corrigió fijando config.platform.php=8.2.0, pero hay que institucionalizarlo).
- Deuda menor/ruido técnico: warnings de Sass por @import deprecado (no bloquea hoy, pero conviene planear migración a @use).
- “Hecho” vs “aceptado”: en artefactos no siempre queda trazado el cierre de aceptación externa (demo/PO) ni despliegue.

## Hallazgos relevantes de code review (resumen)

- Story 1.3 (Auth): se reforzó el alineamiento MVP (features deshabilitadas verificadas como 404) para evitar suposiciones en tests/rutas; traducción/copy se trató como alcance separado (UI base).
- Story 1.8 (Layout + navegación): se corrigieron hallazgos críticos de UX/A11y (logout sin depender de JS, foco visible consistente, `aria-current`) y se fortalecieron tests.
- Story 1.11 (Polling): se corrigió un bug sutil de boolean props (strings truthy) y se endureció el render seguro de atributos; se agregó kill-switch global con tests y documentación.
- Story 1.7 (CI/calidad): se agrego pipeline; el enforcement sera manual (PR + CI verde) al no usar Branch Protection.

## Insights / Lecciones aprendidas

1. **Guardrails + pruebas tempranas**: cuando cada story incluye checks mínimos, los code reviews se enfocan en calidad real (no en bugs básicos).
2. **Definir explícitamente lo deshabilitado**: tratar features fuera de alcance como 404/“no disponible” evita tests frágiles y reduce ambigüedad.
3. **Endpoints de smoke/dev son útiles, pero deben estar acotados**: rutas de demo deben vivir solo en `local/testing`.
4. **Wrappers/configs globales pagan rápido**: polling y UI patterns centralizados evitan inconsistencias entre componentes.
5. **El control de merges es parte del sistema**: sin Branch Protection, el guardrail lo hacemos via politica de PR + CI verde (manual).

## Action Items (compromisos) — sin estimaciones

### Proceso

1. **No usar Branch Protection; aplicar politica de merges manual** (repo privado / restricciones de plan).
   - Owner: Carlos (Project Lead)
   - Deadline: Antes de mergear la siguiente PR a `main`
   - Criterio de exito: solo se mergea via PR con CI verde (verificado manualmente)
2. **Checklist de cierre de story** (mínimo): git status limpio + Pint + tests + (si aplica) Larastan.
   - Owner: Bob (Scrum Master) + equipo
   - Deadline: Antes de iniciar Epic 2
   - Criterio de éxito: cada story nueva termina con evidencia/nota de validación en su artefacto

### Técnico

3. **Estandarizar baseline de PHP** (8.2+) como política: docs + CI + composer.
   - Owner: Winston (Architect) + Charlie (Senior Dev)
   - Deadline: Antes de crear la primera story “ready-for-dev” de Epic 2
   - Criterio de éxito: composer install reproduce el mismo lock y CI valida en PHP 8.2

4. **Plan de migración Sass @import -> @use** (o documentar decisión de posponer).
   - Owner: Charlie (Senior Dev)
   - Deadline: Antes de endurecer el pipeline de frontend (si aplica)
   - Criterio de éxito: build sin warnings de deprecación o con excepción documentada

5. **Aterrizar política de retención/limpieza** de reportes de error (y parámetros de redacción/allowlist).
   - Owner: Winston (Architect)
   - Deadline: Antes de exponer el sistema a usuarios fuera del equipo
   - Criterio de éxito: configuración explícita + ruta de operación (comando/cron) definida

### Documentación / Artefactos

6. **Normalizar la ubicación del documento de epics para workflows**.
   - Owner: Paige (Technical Writer) + Bob (Scrum Master)
   - Deadline: Antes de correr el siguiente retrospective
   - Criterio de éxito: el workflow encuentra el Epic siguiente sin depender de rutas “anidadas”

## Preparación para Epic 2 (Catálogos base)

### Contexto

Epic 2 (según `pics.md y sprint-status) cubrirá catálogos: Categorías, Marcas, Ubicaciones y soft-delete/restauración.

### Riesgos / Dependencias

- Definir reglas de integridad con soft-delete (qué se permite borrar, qué se bloquea, qué se restaura, y efectos colaterales).
- Asegurar RBAC: operaciones CRUD solo para roles permitidos, sin “agujeros” por rutas/componentes.
- Consistencia UX: reutilizar toasts/overlay/freshness para CRUDs sin reinventar.

### Tareas de preparación (propuestas)

- [ ] Alinear criterios de soft-delete/restauración (PO + Arquitectura): “qué significa eliminar” por catálogo.
- [ ] Definir contratos de unicidad/normalización (case-insensitive, slugs, códigos, etc.) para catálogos.
- [ ] Plantilla de pruebas para CRUD Livewire (feature tests por rol + happy path + validaciones).
- [ ] Revisar seeds mínimos necesarios para operar (catálogos iniciales y/o vacíos permitidos).

### Critical Path sugerido (antes de arrancar Epic 2)

1. Politica de merges manual aplicada (Action Item #1)
2. Reglas de soft-delete/restauración acordadas y documentadas
3. Política mínima de validación de PRs (Action Item #2)

## Readiness Assessment (Epic 1)

- **Testing & Quality:** hay evidencia de ejecución de suite (tests y checks) en múltiples stories y reportes `validation-report-*.md`. Recomendación: mantener checklist de cierre por story y dejar trazado de validación.
- **Deployment:** no registrado en artefactos (pendiente trazar “estado de despliegue” cuando aplique).
- **Stakeholder/PO Acceptance:** no queda un “sign-off” formal en artefactos (recomendación: agregar un bloque de aceptación por story/epic cuando aplique).
- **Enforce de merges:** NO activaremos Branch Protection (repo privado / restricciones de plan). Mitigacion: merges a `main` solo via PR + CI verde verificado manualmente.
- **Bloqueadores conocidos:** no se observan bloqueadores técnicos críticos en los artefactos, pero sí pendientes manuales/proceso.

## Acuerdos del equipo

- Toda ruta `/dev/*` debe estar limitada a `local/testing`.
- Features fuera de alcance se tratan como “no disponibles” (404) y se prueban así.
- Cada story cierra con evidencia mínima de validación y git status limpio.

## Cierre

Epic 1 deja un baseline solido para construir inventario con seguridad, UI consistente y calidad minima automatizada. El foco inmediato es hacer cumplir la politica de PR + CI verde (sin Branch Protection) y evitar regresiones de entorno.


